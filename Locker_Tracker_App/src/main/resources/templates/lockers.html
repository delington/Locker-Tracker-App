<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymleaf.org">

<head>
    <link rel="stylesheet" type="text/css" href="/css/main.css" />
</head>
<body>
	<h1 th:text="#{lockers.header}"></h1>
	<a th:text="#{button.users}" href="/users"></a>
	<form id="formLogout" th:action="@{/logout}" method="POST">
        <a th:text="#{button.logout}" id="logoutAnchor" href="javascript:{}" onclick="submitLogout()"></a>
    </form>
	<div>
		<table>
			<tr>
				<th th:text="#{table.header.locker-id}"></th>
				<th th:text="#{table.header.owner-email}"></th>
				<th th:text="#{table.header.action}"></th>
			</tr>
			<tr th:each="locker : ${lockers}">
				<td class="idColumn" th:text="${locker.id}">Locker identifier</td>
				<td th:text=" ${locker.owner != null} ? ${locker.owner.email} : 'Free'">Email</td>
				<td class="editable" th:if="${locker.owner == null}">
				    <form action="#" th:action="@{/edit}" method="POST">
						<button th:text="#{button.reserve}" style="height: 50px; width: 70px" type="submit" name="lockerId" th:value="${locker.id}"></button>
					</form>
				</td>
				<td th:class="${locker.owner != null and userEmail == locker.owner.email} ? 'removable' : ''" th:if="${locker.owner != null}">
				    <form th:if="${userEmail == locker.owner.email}" th:action="@{/remove}" th:method="DELETE">
                        <button th:text="#{button.remove}" name="lockerId" th:value="${locker.id}" style="height: 50px; width: 70px" type="submit"></button>
                    </form>
				</td>
			</tr>
		</table>
	</div>
	
	<script>
		submitLogout = () => {
			document.getElementById('formLogout').submit();
		}
	</script>
</body>
</html>